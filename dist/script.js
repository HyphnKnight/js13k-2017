(function(){'use strict';function a(a,b=8){const c=Math.pow(10,b);return Math.round(a*c)/c}function b(b,d){const e=h(d),f=g(d);return[a(b[0]*f-b[1]*e),a(b[0]*e+b[1]*f)]}async function c(a,b){if(``===a)return await zb(0.75*(1e3*b));const c=yb.createOscillator(),d=yb.createGain();c.connect(d),c.type=`sawtooth`,c.frequency.value=a,d.connect(yb.destination),c.start(0),d.gain.exponentialRampToValueAtTime(1e-5,yb.currentTime+b),await zb(0.75*(1e3*b))}async function d(a){for(let b=-1,d=-1;++b<a.length;){const[e,f]=a[b];if(Array.isArray(e)){for(;++d<e.length-1;)c(e[d],Array.isArray(f)?f[d]:f);c(e[d],Array.isArray(f)?f[d]:f),await zb(0.75*(1e3*(Array.isArray(f)?j(...f):f))),d=-1}else await c(e,f)}return await!0}var e=Math.max,f=Math.abs,g=Math.cos,h=Math.sin,j=Math.min;let k=0,l=0;const m=document.querySelector(`canvas`),n=m.getContext(`2d`);n.imageSmoothingEnabled=!1;const o=160,p=192;let q=m.offsetWidth,r=m.offsetHeight,s=1,t=1;m.width=o,m.height=p;const u=()=>{const{top:a,left:b,width:c,height:d}=m.getBoundingClientRect();q=b,r=a,s=o/c,t=p/d};u(),window.addEventListener(`resize`,u);const v=(...a)=>{let b=0;for(let c=a.length-1;0<=c;--c)b+=a[c];return b},w=(a)=>0<a?1:0>a?-1:0,x=(a)=>a*a,y=(a,b)=>(a[0]+=b[0],a[1]+=b[1],a),z=(a,b)=>[a[0]-b[0],a[1]-b[1]],A=(a,b)=>(a[0]-=b[0],a[1]-=b[1],a),B=(a,b)=>(a[0]*=b,a[1]*=b,a),C=(a)=>x(a[0])+x(a[1]),D=(a)=>Math.sqrt(C(a)),E=(a)=>0===a[0]&&0===a[1]?[0,0]:B(a,1/D(a)),F=(a,b)=>B(E(a),b),G=(a,b)=>{const c=[];for(let d=0,e=a.length;d<e;d+=2)c[d]=a[d]+b[0],c[d+1]=a[d+1]+b[1];return c},H=(a,b)=>{for(let c=0,d=a.length;c<d;c+=2)a[c]+=b[0],a[c+1]+=b[1];return a},I=(a,b)=>{const c=[];for(let d=0,e=a.length;d<e;d+=2)c[d]=a[d]-b[0],c[d+1]=a[d+1]-b[1];return c},J=(b,d)=>{const e=[],f=h(d),j=g(d);for(let c=0,g=b.length;c<g;c+=2)e[c]=a(b[c]*j-b[c+1]*f),e[c+1]=a(b[c]*f+b[c+1]*j);return e},K=(a,b,c)=>G(J(I(a,b),c),b),L=()=>Math.random().toString(36).substr(2,9)+Math.random().toString(36).substr(2,9),M=(a,b)=>[-a/2,+b/2,-a/2,-b/2,+a/2,-b/2,+a/2,+b/2],N=(a,b=0,c=1,d=1,e=``)=>({id:L(),shape:`Rectangle`,label:e,position:a,rotation:b,width:c,height:d,points:M(c,d)}),O=[0,0],P=(b)=>(c)=>b.translate(a(c[0],0),a(c[1],0)),Q=(a)=>(b)=>a.rotate(b),R=(b)=>(c,d,e)=>b.clearRect(a(c[0],0),a(c[1],0),a(d,0),a(e,0)),S=(a,b)=>()=>R(a)(O,b.width,b.height),T=(b)=>(c)=>b.moveTo(a(c[0],0),a(c[1],0)),U=(b)=>(c)=>b.lineTo(a(c[0],0),a(c[1],0)),V=(b)=>(c,d)=>b.quadraticCurveTo(a(d[0],0),a(d[1],0),a(c[0],0),a(c[1],0)),W=(b)=>(c,d,e,f,g)=>b.arc(a(c[0],0),a(c[1],0),d,e,f,g),X=(b)=>(c,d,e)=>b.rect(a(c[0],0),a(c[1],0),a(d,0),a(e,0)),Y=(b)=>(c)=>(d,e,f)=>b.drawImage(c,a(d[0],0),a(d[1],0),e,f),Z=(b)=>(c)=>(d,e,f,g,h,i)=>b.drawImage(c,a(e[0],0),a(e[1],0),f,g,a(d[0],0),a(d[1],0),h,i),$=(a)=>(b,c=0)=>{const d=[b[0],b[1]],e=I(b,d);a.save(),P(a)(d),Q(a)(c),T(a)([0,0]);for(let d=0;d<e.length;d+=2)U(a)([e[d],e[d+1]]);a.restore()},_=(a)=>(b,c,d=0)=>{a.save(),P(a)(b),Q(a)(d),T(a)([c[c.length-2],c[c.length-1]]);for(let e=0;e<c.length;e+=2)U(a)([c[e],c[e+1]]);a.restore()},aa=(b)=>(c,d,e,f=0)=>{b.save(),P(b)(c),Q(b)(f),X(b)([-d/2,-e/2],a(d,0),a(e,0)),b.restore()},ba=(a)=>(b,c,d=100,e=0,f=2*Math.PI,g=!1)=>{a.save(),P(a)(b),Q(a)(c),W(a)([0,0],d,e,f,g),a.restore()},ca=(a)=>(b)=>(c,...d)=>{b.save(),b.beginPath(),b.fillStyle=c,a(b)(...d),b.fill(),b.restore()},da=(a)=>(b)=>(c,d,...e)=>{b.save(),b.beginPath(),b.strokeStyle=c,b.lineWidth=d,a(b)(...e),b.stroke(),b.restore()},ea=ca(_),fa=ca(aa),ga=ca($),ha=ca(ba),ia=da(_),ja=da(aa),ka=da($),la=da(ba),ma=(b)=>(c,d,e)=>{b.save(),b.strokeStyle=c.style||``,b.font=c.font||b.font,b.textAlign=c.textAlign||b.textAlign,b.textBaseline=c.textBaseline||b.textBaseline,b.strokeText(e,a(d[0],0),a(d[1],0),c.maxWidth),b.restore()},na=(b)=>(c,d,e)=>{b.save(),b.fillStyle=c.style||``,b.font=c.font||b.font,b.textAlign=c.textAlign||b.textAlign,b.textBaseline=c.textBaseline||b.textBaseline,b.fillText(e,a(d[0],0),a(d[1],0),c.maxWidth),b.restore()},oa=(a)=>({ctx:a,canvas:a.canvas,translate:P(a),rotate:Q(a),moveTo:T(a),lineTo:U(a),quadraticCurveTo:V(a),arc:W(a),drawLine:$(a),drawPolygon:_(a),drawArc:ba(a),drawImage:Y(a),drawSlicedImage:Z(a),fillRectangle:fa(a),fillPolygon:ea(a),fillLine:ga(a),fillArc:ha(a),fillText:na(a),strokePolygon:ia(a),strokeRectangle:ja(a),strokeLine:ka(a),strokeArc:la(a),strokeText:ma(a),clearRect:R(a),clear:S(a,a.canvas)});class pa{constructor(){this.position=O,this.rotation=0,this.saved_positions=[],this.saved_rotations=[]}apply(a){const b=[this.position[0],this.position[1]],c=this.rotation;return Object.assign(Object.create(null),a,{id:L(),position:b,rotation:c})}save(){this.saved_positions.push([this.position[0],this.position[1]]),this.saved_rotations.push(this.rotation)}restore(){if(0<this.saved_positions.length){const a=this.saved_positions.pop();a&&(this.position[0]=a[0],this.position[1]=a[1]);const b=this.saved_rotations.pop();!b&&0!==b||(this.rotation=b)}}}const qa=(a,b)=>w((b[2]-b[0])*(a[1]-b[1])-(b[3]-b[1])*(a[0]-b[0])),ra=(a,b,c)=>C(z(a,b))<=x(c),sa=(a,b,c,d)=>f(a[0]-b[0])<=c/2&&f(a[1]-b[1])<=d/2,ta=(a,b)=>{const c=Math.floor(b.length/2);for(let d=0;d<c;d+=2){const e=d==c-1?0:d+1;if(-1===qa(a,[b[d],b[d+1],b[e],b[e+1]]))return!0}return!1},ua=(a,b,c,d,f)=>sa(a,c,d,f)||ra(c,a,b)||x(a[0]-e(c[0],j(a[0],c[0]+d)))+x(a[1]-e(c[1],j(a[1],c[1]+f)))<x(b),va=(a,b,c,d,e,g)=>!(f(d[0]-a[0])>b/2+e/2||f(d[1]-a[1])>c/2+g/2),wa=(a,b,c,d)=>{if(ta(a,d)||ta(c,b))return!0;const f=e(b.length,d.length);for(let e=0;e<f;e+=2)if(e<b.length&&ta([b[e],b[e+1]],d)||e<d.length&&ta([d[e],d[e+1]],b))return!0;return!1},xa=new Map,ya=new Map,za=new Map,Aa=N([0,0],0,window.innerWidth,window.innerHeight,`window`);window.onresize=()=>Object.assign(Aa,N([0,0],0,window.innerWidth,window.innerHeight,`window`));const Ba=((a=Aa)=>(b)=>{const{geometry:c={shape:null}}=b;switch(c.shape){case`Circle`:return ua(c.position,c.radius,a.position,a.width,a.height);case`Rectangle`:return va(c.position,c.width,c.height,a.position,a.width,a.height);case`Polygon`:return wa(c.position,H(K(c.points,[0,0],c.rotation),c.position),a.position,H(K(a.points,[0,0],a.rotation),a.position));default:return!0;}})(Aa),Ca=(a,c)=>(d)=>{const{geometry:e,children:f,render:g,interact:h}=d,{ctx:i,translate:j,rotate:k}=c;i.save(),a.save(),e&&(j(e.position),y(a.position,b(e.position,a.rotation)),k(e.rotation),a.rotation+=e.rotation),i.save(),g&&(!e||Ba(a.apply(e)))&&g(c,d),i.restore(),f&&f.forEach(Ca(a,c)),h&&(h.onMouseDown?xa.set(d,[d,e&&a.apply(e),h.onMouseDown]):xa.delete(d),h.onMouseMove?ya.set(d,[d,e&&a.apply(e),h.onMouseMove]):ya.delete(d),h.onMouseUp?za.set(d,[d,e&&a.apply(e),h.onMouseUp]):za.delete(d)),i.restore(),a.restore()},Da=`ontouchstart`in window,Ea=(a)=>{if(a.clientX)return[a.clientX,a.clientY];else{const b=a.touches[0];return[b.clientX,b.clientY]}},Fa=(a)=>(b)=>{switch(b.shape){case`Circle`:return ra(a,b.position,b.radius);case`Rectangle`:return sa(a,b.position,b.width,b.height);case`Polygon`:return ta(a,H(K(b.points,[0,0],b.rotation),b.position));default:return!1;}},Ga=(a)=>(b)=>{if(a.size){const c=A(Ea(b),[q,r]);c[0]*=s,c[1]*=t;const d=Fa(c);[...a.values()].filter(([a,b])=>!b||d(b)).forEach(([a,b,d])=>d(a,c))}},Ha=[],Ia=()=>{for(;Ha.length;)Ha.pop()},{palette:Ja,render:Ka}=((a,b)=>{const c=oa(a.getContext(`2d`));return c.clear(),a.addEventListener(Da?`ontouchstart`:`mousedown`,Ga(xa)),a.addEventListener(Da?`ontouchmove`:`mousemove`,Ga(ya)),a.addEventListener(Da?`ontouchend`:`mouseup`,Ga(za)),{palette:c,render:()=>Ca(new pa,c)(b)}})(m,{geometry:N([m.width/2,m.height/2],0,m.width,m.height),children:Ha,render({canvas:a},{geometry:b}){b.position[0]=a.width/2,b.position[1]=a.height/2,b.width=a.width,b.height=a.height,b.points=M(b.width,b.height)}}),La=`\uD83D\uDC69\uD83C\uDFFC\u200D\uD83C\uDF3E`,Ma=`\uD83D\uDC6E\uD83C\uDFFF\u200D\u2640\uFE0F`,Na=`\uD83D\uDD75\uD83C\uDFFD`,Oa=`\uD83D\uDC69\uD83C\uDFFB\u200D\uD83C\uDFA4`,Pa=`\uD83C\uDF32`,Qa=`\uD83C\uDF33`,Ra=`\u2601\uFE0F`,Sa=`\uD83C\uDF75`,Ta=`\uD83D\uDC8E`,Ua={dialog:[[`yolo`,[Oa,`ya mum`]]],position:[0,0]},Va=[0,120,200],Wa=[],{fillPolygon:Xa,fillText:Ya,ctx:Za}=Ja,$a=N([0,800],0,1e4,1600),_a=N([0,0],0,2*o,2*p),ab=Za.createLinearGradient(0,0,200,200);ab.addColorStop(0,`#5E8C6A`),ab.addColorStop(1,`#BFB35A`);const bb=Za.createLinearGradient(0,0,200,200);bb.addColorStop(0,`#69D2E7`),bb.addColorStop(1,`#A7DBD8`);const cb={38:`up`,40:`down`,37:`left`,39:`right`,81:`q`,87:`w`,69:`e`,65:`a`,83:`s`,68:`d`,48:`0`,49:`1`,50:`2`,51:`3`,52:`4`,53:`5`,54:`6`,55:`7`,56:`8`,57:`9`,189:`-`,187:`=`,32:`space`,13:`return`,16:`shift`,17:`ctrl`,9:`tab`,18:`alt`},db={up:!1,down:!1,left:!1,right:!1,q:!1,w:!1,e:!1,a:!1,s:!1,d:!1,0:!1,1:!1,2:!1,3:!1,4:!1,5:!1,6:!1,7:!1,8:!1,9:!1,"-":!1,"=":!1,space:!1,return:!1,shift:!1,ctrl:!1,tab:!1,alt:!1,click:!1},eb=(a,b=!0)=>{const c=cb[a];return c&&(db[c]=b),db[c]};document.body.onkeyup=({keyCode:a})=>eb(a,!1),document.body.onkeydown=({keyCode:a})=>eb(a,!0);const fb=(a)=>([b,c],d=0)=>[b,c,d,a],gb=fb(Pa),hb=fb(Qa),ib=fb(La),jb=fb(Ma),kb=fb(Na),lb=fb(Oa),mb=fb(Ra),nb=fb(Sa),ob=fb(Ta),pb=[0,0],qb=3;let rb=1e3;for(;0<--rb;)Wa.push((0.5<Math.random()?gb:hb)([5120*Math.random()-2560,1280*Math.random()],0));for(rb=25;0<--rb;)Wa.push(mb([1e4*Math.random()-5e3,1e3*Math.random()+3500],30*Math.random()+10));for(rb=5;0<--rb;)Wa.push(nb([5120*Math.random()-2560,1280*Math.random()],0));const i=lb([20*Math.random()-10,20*Math.random()-10],0),sb=ib([20*Math.random()-10,20*Math.random()-10],0),tb=jb([20*Math.random()-10,20*Math.random()-10],0),ub=kb([20*Math.random()-10,20*Math.random()-10],0),vb=ob([20*Math.random()-10,20*Math.random()-10],0),wb=()=>(a,b)=>{const c=z(Ua.position,a);D(c)>b&&y(a,F(c,qb))};Wa.push(i,sb,tb,ub,vb);var xb=()=>{pb[0]=0,pb[1]=0,(db.w||db.up)&&(pb[1]+=1),(db.s||db.down)&&(pb[1]-=1),(db.d||db.right)&&(pb[0]+=1),(db.a||db.left)&&(pb[0]-=1),y(Ua.position,F(pb,qb)),Ua.position[1]=e(Ua.position[1],5),i[0]=Ua.position[0],i[1]=Ua.position[1];const a=wb(i);a(sb,20+Date.now()%300/30),a(tb,45+Date.now()%300/30),a(ub,70+Date.now()%300/30),a(vb,90+Date.now()%300/30);const b=Ua.position[0]-Va[0];f(b)>0.2*o&&(Va[0]+=b-0.2*(w(b)*o))};const yb=new AudioContext,zb=(a)=>new Promise((b)=>setTimeout(b,a)),Ab=261.63,Bb=329.63,Cb=349.23,Db=392,Eb=440,Fb=493.88,Gb=523.25,Hb=587.33,Ib=659.26,Jb=698.46,Kb=783.99,Lb=880,Mb=987.77,Nb=1046.5,Ob=1174.66,Pb=1318.51,Qb=1396.91,Rb=1567.98,Sb=async()=>await d([[[Ib,Gb],1],[[Hb,Db],1],[[Gb,Eb],1],[[Fb,Bb],1],[[Eb,Cb],1],[[Db,Ab],1],[[Eb,Cb],1],[[Fb,Db],1],[[Pb,Kb,Gb],1],[[Ob,Mb,Db],1],[[Nb,Eb],1],[[Mb,Kb,Bb],1],[[Lb,Gb,Cb],1],[[Kb,Ib,Ab],1],[[Lb,Jb,Cb],1],[[Mb,Hb,Db],1],[[Nb,Gb,Ib],[0.5,1,1]],[Nb,0.5],[[Ob,Hb,Db],[0.5,1,1]],[Mb,0.5],[[Nb,Ib,Lb],[0.5,1,1]],[Pb,0.5],[[Rb,Bb],[0.5,1,1]],[Kb,0.5],[[Lb,Eb,Cb],[0.5,1,1]],[Jb,0.5],[[Ib,Ab],[0.5,1,1]],[Kb,0.5],[[Jb,Eb,Cb],[0.5,1,1]],[Nb,0.5],[[Mb,Fb,Db],[0.5,1,1]],[Kb,0.5],[[Nb,Ib,Gb],[0.5,1,1]],[Pb,0.25],[Rb,0.25],[[Rb,Db],[0.25,1,1]],[1760,0.25],[Rb,0.25],[Qb,0.25],[[Pb,Eb,Gb],[0.75,1,1]],[Pb,0.25],[[Pb,Db,Bb],[0.25,1,1]],[Qb,0.25],[Pb,0.25],[Ob,0.25],[[Nb,Eb,Cb],[0.25,1,1]],[932.33,0.25],[Lb,0.25],[Mb,0.25],[[Kb,Bb,Ab],[0.5,1,1]],[Ib,0.5],[[Gb,Eb,Cb],[0.5,1,1]],[Jb,0.25],[Ib,0.25],[[Hb,Fb,Db],[0.5,1,1]],[Kb,0.25],[Jb,0.25],[[``,Ib,Gb],[0.5,1,1]],[Nb,0.5],[[Ob,Db],[0.5,1,1]],[Mb,0.5],[[Nb,Gb,Eb],[0.5,1,1]],[Ib,0.5],[[Kb,Fb,Bb],[0.75,1,1]],[Lb,0.25],[[Jb,Eb,Cb],[0.5,1,1]],[Gb,0.5],[[Ib,Db,Ab],[0.5,1,1]],[Kb,0.5],[[Jb,Eb,Cb],[0.5,1,1]],[Ib,0.5],[[Hb,Fb,Db],[0.5,1,1]],[Kb,0.5],[[Ib,Gb,Ab],[2,2,2]]]),Tb=`Arial Black, Gadget, sans-serif`,Ub=`"Lucida Console", Monaco, monospace`,Vb=`24px ${Tb}`,Wb=`12px ${Ub}`;let Xb=null,Yb=0;const Zb={textBaseline:`middle`,style:'white',font:Vb},$b={geometry:N([0,0],0,m.width,m.height),render:({ctx:a,fillText:b,fillPolygon:c})=>{if(Xb||(Xb=Date.now(),Sb()),Yb=j((Date.now()-Xb)/24000,1),b(Zb,[1<animTime/24000?-11:10*(f((animTime-1500)%6e3/600-5)-2.5)-11,height-1.125*(j(animTime/24000,1)*height)],Ta),b(Zb,[-59,-m.height/2+j(2*Yb,1)*m.height/2],`A L T E R`),1.1<Yb){a.font=Wb;const{width:d}=a.measureText(`new game`);b({style:'white',font:Wb},[-d/2-2,48],`new game`),400<Date.now()%600&&c(`white`,[-42,44],[-5,3,5,0,-5,-3])}db.space&&1>Yb?Xb/=2:db.space&&console.log('Start Game')},interact:{onMouseDown(){1>Yb?Xb/=2:console.log('Start Game')}}};(()=>{Xb=null,Ia(),Ha.push($b)})(),((a)=>{let b=!0;return requestAnimationFrame(function c(){k=j(16,Date.now()-l),b&&a(k),l=Date.now(),requestAnimationFrame(c)}),()=>b=!b})((a)=>{xb(a),Ja.clear(),Ka()})})();
var Alter=function(a){'use strict';function b(a,b){for(let c=-1;++c<a.length;)b(a[c],c,a);return a}function c(a,b,c){for(let d=-1;++d<a.length;)c=b(c,a[d],d,a);return c}function d(a,b=1){const c=[];for(let d=0;d<b&&d<a.length;)c.push(a[d++]);return c}function e(a,b=8){const c=p(10,b);return Math.round(a*c)/c}function f(a,b){const d=n(b),f=m(b);return[e(a[0]*f-a[1]*d),e(a[0]*d+a[1]*f)]}async function g(a,b){if(``===a)return await oa(0.75*(1e3*b));const c=na.createOscillator(),d=na.createGain();d.gain.value=1.1-l(1,(Date.now()-pa)/3e3),c.connect(d),c.type=`square`,c.frequency.value=a,d.connect(na.destination),c.start(0),d.gain.exponentialRampToValueAtTime(1e-5,na.currentTime+b),await oa(0.75*(1e3*b))}async function h(a){qa=!1;for(let b=-1,c=-1;!qa&&++b<a.length;){const[d,e]=a[b];if(Array.isArray(d)){for(;++c<d.length-1;)g(d[c],Array.isArray(e)?e[c]:e);g(d[c],Array.isArray(e)?e[c]:e),await oa(0.75*(1e3*(Array.isArray(e)?l(...e):e))),c=-1}else await g(d,e)}return await!0}var j=Math.max,k=Math.abs,l=Math.min,m=Math.cos,n=Math.sin,o=Math.sqrt,p=Math.pow;const q=(a,b)=>c(a,(a,c,d,e)=>u(a,b(c,d,e)),[]),r=(a,b=(a)=>!!a)=>c(a,(a,c,d,e)=>b(c,d,e)?u(a,c):a,[]),s=(a)=>a.slice(0),u=(a,b,c=0)=>s(a).splice(c,0,b),v=(...a)=>{let b=0;for(let c=a.length-1;0<=c;--c)b+=a[c];return b},w=(a)=>0<a?1:0>a?-1:0,x=(a)=>a*a,y=(a=(a)=>!!a)=>(b)=>a(b),z=y((a)=>'number'==typeof a),A=y((a)=>z(a[0])&&z(a[1])),B=(a,b)=>(a[0]+=b[0],a[1]+=b[1],a),C=(a,b)=>[a[0]-b[0],a[1]-b[1]],D=(a,b)=>(a[0]-=b[0],a[1]-=b[1],a),E=(a,b)=>(a[0]*=b,a[1]*=b,a),F=(a)=>x(a[0])+x(a[1]),G=(a)=>o(F(a)),H=(a)=>0===a[0]&&0===a[1]?[0,0]:E(a,1/G(a)),I=(a,b)=>E(H(a),b),J=(a,b)=>{const c=[];for(let d=0,e=a.length;d<e;d+=2)c[d]=a[d]+b[0],c[d+1]=a[d+1]+b[1];return c},K=(a,b)=>{for(let c=0,d=a.length;c<d;c+=2)a[c]+=b[0],a[c+1]+=b[1];return a},L=(a,b)=>{const c=[];for(let d=0,e=a.length;d<e;d+=2)c[d]=a[d]-b[0],c[d+1]=a[d+1]-b[1];return c},M=(a,b)=>{const d=[],f=n(b),g=m(b);for(let c=0,h=a.length;c<h;c+=2)d[c]=e(a[c]*g-a[c+1]*f),d[c+1]=e(a[c]*f+a[c+1]*g);return d},N=(a,b,c)=>J(M(L(a,b),c),b),O=(a,b)=>{for(let c=0;c<a.length;c+=2)b([a[c],a[c+1]],c/2,a)},P=()=>Math.random().toString(36).substr(2,9)+Math.random().toString(36).substr(2,9),Q=(a,b)=>[-a/2,+b/2,-a/2,-b/2,+a/2,-b/2,+a/2,+b/2],R=(a,b=0,c=1,d=1,e='')=>({id:P(),shape:'Rectangle',label:e,position:a,rotation:b,width:c,height:d,points:Q(c,d)});let S=document.createElement('canvas'),T=S.getContext('2d');const U=(a)=>{S=a;const b=a.getContext('2d');b&&(T=b)},V=[0,0],W=(a)=>T.translate(e(a[0],0),e(a[1],0)),X=(a)=>T.rotate(a),Y=(a,b,c)=>T.clearRect(e(a[0],0),e(a[1],0),e(b,0),e(c,0)),Z=()=>Y(V,S.width,S.height),$=(a)=>T.moveTo(e(a[0],0),e(a[1],0)),_=(a)=>T.lineTo(e(a[0],0),e(a[1],0)),aa=(a,b,c)=>T.rect(e(a[0],0),e(a[1],0),e(b,0),e(c,0)),ba=(a)=>(b,...c)=>{T.save(),T.beginPath(),T.fillStyle=b,a(...c),T.fill(),T.restore()},ca=ba((a,b,c=0)=>{const d=[b[b.length-2],b[b.length-1]];T.save(),W(a),X(c),$(d),O(b,_),T.restore()}),da=ba((a,b,c,d=0)=>{T.save(),W(a),X(d),aa([-b/2,-c/2],e(b,0),e(c,0)),T.restore()}),ea=(a,b,c)=>{T.save(),T.fillStyle=a.style||'',T.font=a.font||T.font,T.textAlign=a.textAlign||T.textAlign,T.textBaseline=a.textBaseline||T.textBaseline,T.fillText(c,e(b[0],0),e(b[1],0),a.maxWidth),T.restore()},fa=document.querySelector(`canvas`);U(fa),T.imageSmoothingEnabled=!1;const ga=160,ha=192;let ia=fa.offsetWidth,ja=fa.offsetHeight,ka=1,la=1;fa.width=ga,fa.height=ha;const ma=()=>{const{top:a,left:b,width:c,height:d}=fa.getBoundingClientRect();ia=b,ja=a,ka=ga/c,la=ha/d};ma(),window.addEventListener(`resize`,ma);const na=new AudioContext,oa=(a)=>new Promise((b)=>setTimeout(b,a)),pa=Date.now();let qa=!1;const ra=82.41,sa=87.31,ta=98,ua=110,va=130.81,wa=164.81,xa=174.61,ya=196,za=220,Aa=246.94,Ba=261.63,Ca=293.66,Da=329.63,Ea=349.23,Fa=392,Ga=440,Ha=493.88,Ia=523.25,Ja=587.33,Ka=659.26,La=783.99,Ma=880,Na=987.77,Oa=async()=>await h([[[Da,Ba],1],[[Ca,ya],1],[[Ba,za],1],[[Aa,wa],1],[[za,xa],1],[[ya,va],1],[[za,xa],1],[[Aa,ya],1],[[1318.51,La,Ia],1],[[1174.66,Na,Fa],1],[[1046.5,Ga],1],[[Na,La,Da],1],[[Ma,Ia,Ea],1],[[La,Ka,Ba],1],[[Ma,698.46,Ea],1],[[Na,Ja,Fa],1],[[Ia,Ba,Da],[0.5,1,1]],[Ia,0.5],[[Ja,Ca,ya],[0.5,1,1]],[Ha,0.5],[[Ia,Da,Ga],[0.5,1,1]],[Ka,0.5],[[La,wa],[0.5,1,1]],[Fa,0.5],[[Ga,za,xa],[0.5,1,1]],[Ea,0.5],[[Da,va],[0.5,1,1]],[Fa,0.5],[[Ea,za,xa],[0.5,1,1]],[Ia,0.5],[[Ha,Aa,ya],[0.5,1,1]],[Fa,0.5],[[Ba,wa,va],[0.5,1,1]],[Da,0.25],[Fa,0.25],[[Fa,ta],[0.25,1,1]],[Ga,0.25],[Fa,0.25],[Ea,0.25],[[Da,ua,va],[0.75,1,1]],[Da,0.25],[[Da,ta,ra],[0.25,1,1]],[Ea,0.25],[Da,0.25],[Ca,0.25],[[Ba,ua,sa],[0.25,1,1]],[233.08,0.25],[za,0.25],[Aa,0.25],[[ya,ra,65.41],[0.5,1,1]],[wa,0.5],[[va,ua,sa],[0.5,1,1]],[xa,0.25],[wa,0.25],[[146.83,123.47,ta],[0.5,1,1]],[ya,0.25],[xa,0.25],[[``,Da,Ba],[0.5,1,1]],[Ia,0.5],[[Ja,ya],[0.5,1,1]],[Ha,0.5],[[Ia,Ba,za],[0.5,1,1]],[Da,0.5],[[Fa,Aa,wa],[0.75,1,1]],[Ga,0.25],[[Ea,za,xa],[0.5,1,1]],[Ba,0.5],[[Da,ya,va],[0.5,1,1]],[Fa,0.5],[[Ea,za,xa],[0.5,1,1]],[Da,0.5],[[Ca,Aa,ya],[0.5,1,1]],[Fa,0.5],[[Da,Ba,va],[2,2,2]]]),Pa=()=>{qa=!0},Qa={38:`up`,40:`down`,37:`left`,39:`right`,81:`q`,87:`w`,69:`e`,65:`a`,83:`s`,68:`d`,48:`0`,49:`1`,50:`2`,51:`3`,52:`4`,53:`5`,54:`6`,55:`7`,56:`8`,57:`9`,189:`-`,187:`=`,32:`space`,13:`return`,16:`shift`,17:`ctrl`,9:`tab`,18:`alt`},Ra={up:!1,down:!1,left:!1,right:!1,q:!1,w:!1,e:!1,a:!1,s:!1,d:!1,0:!1,1:!1,2:!1,3:!1,4:!1,5:!1,6:!1,7:!1,8:!1,9:!1,"-":!1,"=":!1,space:!1,return:!1,shift:!1,ctrl:!1,tab:!1,alt:!1,click:!1},Sa=(a,b=!0)=>{const c=Qa[a];return c&&(Ra[c]=b),Ra[c]};document.body.onkeyup=({keyCode:a})=>Sa(a,!1),document.body.onkeydown=({keyCode:a})=>Sa(a,!0);const Ta=`Arial Black, Gadget, sans-serif`,Ua=`"Lucida Console", Monaco, monospace`,Va=`24px ${Ta}`,Wa=`12px ${Ua}`,Xa=`\uD83D\uDC69\uD83C\uDFFC\u200D\uD83C\uDF3E`,Ya=`\uD83D\uDC6E\uD83C\uDFFF\u200D\u2640\uFE0F`,Za=`\uD83D\uDD75\uD83C\uDFFD`,$a=`\uD83D\uDC69\uD83C\uDFFB\u200D\uD83C\uDFA4`,_a=`\uD83C\uDF32`,ab=`\uD83C\uDF33`,bb=`\u2601\uFE0F`,cb=`\uD83C\uDF75`,db=`\uD83D\uDC8E`;let eb=0,fb=0;var t=(a)=>{let b=!0;return requestAnimationFrame(function c(){eb=l(16,Date.now()-fb),b&&a(eb),fb=Date.now(),requestAnimationFrame(c)}),()=>b=!b};const gb=[0,0];class hb{constructor(){this.apply=(a)=>Object.assign(Object.create(null),a,{position:[...this.position],rotation:this.rotation}),this.position=gb,this.rotation=0,this.saved_positions=[],this.saved_rotations=[]}save(){this.saved_positions.push([this.position[0],this.position[1]]),this.saved_rotations.push(this.rotation)}restore(){if(0<this.saved_positions.length){const a=this.saved_positions.pop();A(a)&&(this.position[0]=a[0],this.position[1]=a[1]);const b=this.saved_rotations.pop();z(b)&&(this.rotation=b)}}}const ib=(a,b)=>w((b[2]-b[0])*(a[1]-b[1])-(b[3]-b[1])*(a[0]-b[0])),jb=(a,b,c)=>F(C(a,b))<=x(c),kb=(a,b,c,d)=>k(a[0]-b[0])<=c/2&&k(a[1]-b[1])<=d/2,lb=(a,b)=>{const c=Math.floor(b.length/2);for(let d=0;d<c;d+=2){const e=d==c-1?0:d+1;if(-1===ib(a,[b[d],b[d+1],b[e],b[e+1]]))return!0}return!1},mb=(a,b,c,d,e)=>kb(a,c,d,e)||jb(c,a,b)||x(a[0]-j(c[0],l(a[0],c[0]+d)))+x(a[1]-j(c[1],l(a[1],c[1]+e)))<x(b),nb=(a,b,c,d,e,f)=>!(k(d[0]-a[0])>b/2+e/2||k(d[1]-a[1])>c/2+f/2),ob=(a,b,c,d)=>{if(lb(a,d)||lb(c,b))return!0;const e=j(b.length,d.length);for(let f=0;f<e;f+=2)if(f<b.length&&lb([b[f],b[f+1]],d)||f<d.length&&lb([d[f],d[f+1]],b))return!0;return!1},pb=new Map,qb=new Map,rb=new Map;let sb=R([0,0],0,window.innerWidth,window.innerHeight,'window');window.onresize=()=>Object.assign(sb,R([0,0],0,window.innerWidth,window.innerHeight,'window'));const tb=((a=sb)=>(b)=>{const{geometry:c={shape:null}}=b;switch(c.shape){case'Circle':return mb(c.position,c.radius,a.position,a.width,a.height);case'Rectangle':return nb(c.position,c.width,c.height,a.position,a.width,a.height);case'Polygon':return ob(c.position,K(N(c.points,[0,0],c.rotation),c.position),a.position,K(N(a.points,[0,0],a.rotation),a.position));default:return!0;}})(sb),ub=(a)=>(c)=>{const{geometry:d,children:e,render:g,interact:h}=c;T.save(),a.save(),!d||(W(d.position),B(a.position,f(d.position,a.rotation)),X(d.rotation),a.rotation+=d.rotation),T.save(),g&&(!d||tb(a.apply(d)))&&g(c),T.restore(),e&&b(e,ub(a)),h&&(h.onMouseDown?pb.set(c,[c,d&&a.apply(d),h.onMouseDown]):pb.delete(c),h.onMouseMove?qb.set(c,[c,d&&a.apply(d),h.onMouseMove]):qb.delete(c),h.onMouseUp?rb.set(c,[c,d&&a.apply(d),h.onMouseUp]):rb.delete(c)),T.restore(),a.restore()},vb='ontouchstart'in window,wb=(a)=>y((a)=>!!a.clientX)(a)?[a.clientX,a.clientY]:[a.touches[0].clientX,a.touches[0].clientY],xb=(a)=>(b)=>{switch(b.shape){case'Circle':return jb(a,b.position,b.radius);case'Rectangle':return kb(a,b.position,b.width,b.height);case'Polygon':return lb(a,K(N(b.points,[0,0],b.rotation),b.position));default:return!1;}};let yb=0,zb=0,Ab=1,Bb=1;const Cb=()=>{const{top:a,left:b,width:c,height:d}=S.getBoundingClientRect();yb=b,zb=a,Ab=window.innerWidth/c,Bb=window.innerHeight/d};Cb(),window.addEventListener('resize',Cb);const Db=(a)=>(c)=>{if(!!a.size){const d=D(wb(c),[yb,zb]);d[0]*=Ab,d[1]*=Bb;const e=xb(d);b(r([...a.values()],([a,b])=>e(b)),([a,b,c])=>c(a,d))}},Eb=[],Fb=()=>{for(;Eb.length;)Eb.pop()},Gb=((a,b)=>(U(a),a.addEventListener(vb?'ontouchstart':'mousedown',Db(pb)),a.addEventListener(vb?'ontouchmove':'mousedown',Db(qb)),a.addEventListener(vb?'ontouchend':'mousedown',Db(rb)),()=>ub(new hb)(b)))(fa,{geometry:R([fa.width/2,fa.height/2],0,fa.width,fa.height),children:Eb,render({geometry:a}){a.position[0]=fa.width/2,a.position[1]=fa.height/2,a.width=fa.width,a.height=fa.height,a.points=Q(a.width,a.height)}});let Hb;const Ib=(a)=>{Fb(),a.init(),Hb&&Hb.dismiss(),Hb=a},Jb=[0,80,140],Kb=((a)=>([b,c])=>{const[d,e,f]=a;return[b+c*(d-b)/(c+e)-d+ga/2,ha-(0===e+c?0:f*c/(e+c)),o(p(e+c,2)+p(d-b,2))]})(Jb),Lb=[],Mb=((a,b)=>{for(let c=0;c<a.length;c+=2)a.splice(c,2,...b([a[c],a[c+1]],c/2));return a})(K(Q(1e4,1600),[0,800]),(a)=>d(Kb(a),2)),Nb=T.createLinearGradient(0,0,200,200);Nb.addColorStop(0,`#5E8C6A`),Nb.addColorStop(1,`#BFB35A`);const Ob=T.createLinearGradient(0,0,200,200);Ob.addColorStop(0,`#69D2E7`),Ob.addColorStop(1,`#A7DBD8`);const Pb=()=>{da(Ob,[0,0],2*ga,ha,0),ca(Nb,[0,0],Mb),Lb.map((a)=>[...Kb(a),a[2],a[3],a[4]]).sort((c,a)=>a[2]-c[2]).forEach(([a,b,c,d,e])=>ea({},[a,b-d],e))},Qb={dialog:[[`yolo`,[$a,`ya mum`]]],position:[0,0]},Rb=(a)=>([b,c],d=0)=>[b,c,d,a],Sb=Rb(_a),Tb=Rb(ab),Ub=Rb(Xa),Vb=Rb(Ya),Wb=Rb(Za),Xb=Rb($a),Yb=Rb(bb),Zb=Rb(cb),$b=Rb(db),_b=[0,0],ac=3;let bc=1e3;for(;0<--bc;)Lb.push((0.5<Math.random()?Sb:Tb)([5120*Math.random()-2560,1280*Math.random()],0));for(bc=25;0<--bc;)Lb.push(Yb([1e4*Math.random()-5e3,1e3*Math.random()+3500],30*Math.random()+10));for(bc=5;0<--bc;)Lb.push(Zb([5120*Math.random()-2560,1280*Math.random()],0));const i=Xb([20*Math.random()-10,20*Math.random()-10],0),cc=Ub([20*Math.random()-10,20*Math.random()-10],0),dc=Vb([20*Math.random()-10,20*Math.random()-10],0),ec=Wb([20*Math.random()-10,20*Math.random()-10],0),fc=$b([20*Math.random()-10,20*Math.random()-10],0),gc=()=>(a,b)=>{const c=C(Qb.position,a);G(c)>b&&B(a,I(c,ac))};Lb.push(i,cc,dc,ec,fc);var hc={init:()=>{_b[0]=0,_b[1]=0,(Ra.w||Ra.up)&&(_b[1]+=1),(Ra.s||Ra.down)&&(_b[1]-=1),(Ra.d||Ra.right)&&(_b[0]+=1),(Ra.a||Ra.left)&&(_b[0]-=1),B(Qb.position,I(_b,ac)),Qb.position[1]=j(Qb.position[1],5),i[0]=Qb.position[0],i[1]=Qb.position[1];const a=gc(i);a(cc,20+Date.now()%300/30),a(dc,45+Date.now()%300/30),a(ec,70+Date.now()%300/30),a(fc,90+Date.now()%300/30);const b=Qb.position[0]-Jb[0];k(b)>0.2*ga&&(Jb[0]+=b-0.2*(w(b)*ga))}};let ic;var jc={init:()=>{ic=t((a)=>{hc.init(a),Z(),Pb(),Gb()})},dismiss:()=>{ic()}};let kc=null,lc=0,mc=0,nc=!1;const oc={textBaseline:`middle`,style:`white`,font:Va},pc={geometry:R([0,0],0,fa.width,fa.height),render:()=>{if(kc||(kc=Date.now(),Oa()),mc=Date.now()-kc,lc=l(mc/24000,1),ea(oc,[1<mc/24000?-11:10*(k((mc-1500)%6e3/600-5)-2.5)-11,fa.height-1.125*(l(mc/24000,1)*fa.height)],db),ea(oc,[-59,-fa.height/2+l(2*lc,1)*fa.height/2],`A L T E R`),24500<mc){T.font=Wa;const{width:a}=T.measureText(`new game`);ea({style:`white`,font:Wa},[-a/2-2,48],`new game`),400<Date.now()%600&&ca(`white`,[-42,44],[-5,3,5,0,-5,-3])}!nc&&(Ra.space||Ra.return)&&1>lc?kc/=2:!nc&&(Ra.space||Ra.return)&&Ib(jc),nc=Ra.space||Ra.return},interact:{onMouseDown(){1>lc?kc/=2:Ib(jc)}}};let qc;const rc=document.querySelector(`canvas`);return U(rc),Ib({init:()=>{kc=null,Eb.push(pc),qc=t(()=>{Z(),Gb()})},dismiss:()=>{Pa();const a=Eb.indexOf(pc);Eb.splice(a,1),qc()}}),a.canvas=rc,a}({});
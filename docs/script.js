(function(){'use strict';function a(a,b=8){const c=l(10,b);return Math.round(a*c)/c}function b(b,d){const e=j(d),f=h(d);return[a(b[0]*f-b[1]*e),a(b[0]*e+b[1]*f)]}async function c(a,b){if(``===a)return await Oa(0.75*(1e3*b));const c=Na.createOscillator(),d=Na.createGain();d.gain.value=1.1-f(1,(Date.now()-Pa)/3e3),c.connect(d),c.type=`square`,c.frequency.value=a,d.connect(Na.destination),c.start(0),d.gain.exponentialRampToValueAtTime(1e-5,Na.currentTime+b),await Oa(0.75*(1e3*b))}async function d(a){Qa=!1;for(let b=-1,d=-1;!Qa&&++b<a.length;){const[e,g]=a[b];if(Array.isArray(e)){for(;++d<e.length-1;)c(e[d],Array.isArray(g)?g[d]:g);c(e[d],Array.isArray(g)?g[d]:g),await Oa(0.75*(1e3*(Array.isArray(g)?f(...g):g))),d=-1}else await c(e,g)}return await!0}var e=Math.max,f=Math.min,g=Math.abs,h=Math.cos,j=Math.sin,k=Math.sqrt,l=Math.pow;const m=(...a)=>{let b=0;for(let c=a.length-1;0<=c;--c)b+=a[c];return b},n=(a)=>0<a?1:0>a?-1:0,o=(a)=>a*a,p=(a,b)=>(a[0]+=b[0],a[1]+=b[1],a),q=(a,b)=>[a[0]-b[0],a[1]-b[1]],r=(a,b)=>(a[0]-=b[0],a[1]-=b[1],a),s=(a,b)=>(a[0]*=b,a[1]*=b,a),u=(a)=>o(a[0])+o(a[1]),v=(a)=>k(u(a)),w=(a)=>0===a[0]&&0===a[1]?[0,0]:s(a,1/v(a)),x=(a,b)=>s(w(a),b),y=(a,b)=>{const c=[];for(let d=0,e=a.length;d<e;d+=2){const[e,f]=b([a[d],a[d+1]]);c[d]=e,c[d+1]=f}return c},z=(a,b)=>{const c=[];for(let d=0,e=a.length;d<e;d+=2)c[d]=a[d]+b[0],c[d+1]=a[d+1]+b[1];return c},A=(a,b)=>{for(let c=0,d=a.length;c<d;c+=2)a[c]+=b[0],a[c+1]+=b[1];return a},B=(a,b)=>{const c=[];for(let d=0,e=a.length;d<e;d+=2)c[d]=a[d]-b[0],c[d+1]=a[d+1]-b[1];return c},C=(b,d)=>{const e=[],f=j(d),g=h(d);for(let c=0,h=b.length;c<h;c+=2)e[c]=a(b[c]*g-b[c+1]*f),e[c+1]=a(b[c]*f+b[c+1]*g);return e},D=(a,b,c)=>z(C(B(a,b),c),b),E=()=>Math.random().toString(36).substr(2,9)+Math.random().toString(36).substr(2,9),F=(a,b)=>[-a/2,+b/2,-a/2,-b/2,+a/2,-b/2,+a/2,+b/2],G=(a,b=0,c=1,d=1,e=``)=>({id:E(),shape:`Rectangle`,label:e,position:a,rotation:b,width:c,height:d,points:F(c,d)}),H=document.querySelector(`canvas`),I=H.getContext(`2d`);I.imageSmoothingEnabled=!1;const J=160,K=192;let L=H.offsetWidth,M=H.offsetHeight,N=1,O=1;H.width=J,H.height=K;const P=()=>{const{top:a,left:b,width:c,height:d}=H.getBoundingClientRect();L=b,M=a,N=J/c,O=K/d};P(),window.addEventListener(`resize`,P);const Q=[0,0],R=(b)=>(c)=>b.translate(a(c[0],0),a(c[1],0)),S=(a)=>(b)=>a.rotate(b),T=(b)=>(c,d,e)=>b.clearRect(a(c[0],0),a(c[1],0),a(d,0),a(e,0)),U=(a,b)=>()=>T(a)(Q,b.width,b.height),V=(b)=>(c)=>b.moveTo(a(c[0],0),a(c[1],0)),W=(b)=>(c)=>b.lineTo(a(c[0],0),a(c[1],0)),X=(b)=>(c,d)=>b.quadraticCurveTo(a(d[0],0),a(d[1],0),a(c[0],0),a(c[1],0)),Y=(b)=>(c,d,e,f,g)=>b.arc(a(c[0],0),a(c[1],0),d,e,f,g),Z=(b)=>(c,d,e)=>b.rect(a(c[0],0),a(c[1],0),a(d,0),a(e,0)),$=(b)=>(c)=>(d,e,f)=>b.drawImage(c,a(d[0],0),a(d[1],0),e,f),_=(b)=>(c)=>(d,e,f,g,h,i)=>b.drawImage(c,a(e[0],0),a(e[1],0),f,g,a(d[0],0),a(d[1],0),h,i),aa=(a)=>(b,c=0)=>{const d=[b[0],b[1]],e=B(b,d);a.save(),R(a)(d),S(a)(c),V(a)([0,0]);for(let d=0;d<e.length;d+=2)W(a)([e[d],e[d+1]]);a.restore()},ba=(a)=>(b,c,d=0)=>{a.save(),R(a)(b),S(a)(d),V(a)([c[c.length-2],c[c.length-1]]);for(let e=0;e<c.length;e+=2)W(a)([c[e],c[e+1]]);a.restore()},ca=(b)=>(c,d,e,f=0)=>{b.save(),R(b)(c),S(b)(f),Z(b)([-d/2,-e/2],a(d,0),a(e,0)),b.restore()},da=(a)=>(b,c,d=100,e=0,f=2*Math.PI,g=!1)=>{a.save(),R(a)(b),S(a)(c),Y(a)([0,0],d,e,f,g),a.restore()},ea=(a)=>(b)=>(c,...d)=>{b.save(),b.beginPath(),b.fillStyle=c,a(b)(...d),b.fill(),b.restore()},fa=(a)=>(b)=>(c,d,...e)=>{b.save(),b.beginPath(),b.strokeStyle=c,b.lineWidth=d,a(b)(...e),b.stroke(),b.restore()},ga=ea(ba),ha=ea(ca),ia=ea(aa),ja=ea(da),ka=fa(ba),la=fa(ca),ma=fa(aa),na=fa(da),oa=(b)=>(c,d,e)=>{b.save(),b.strokeStyle=c.style||``,b.font=c.font||b.font,b.textAlign=c.textAlign||b.textAlign,b.textBaseline=c.textBaseline||b.textBaseline,b.strokeText(e,a(d[0],0),a(d[1],0),c.maxWidth),b.restore()},pa=(b)=>(c,d,e)=>{b.save(),b.fillStyle=c.style||``,b.font=c.font||b.font,b.textAlign=c.textAlign||b.textAlign,b.textBaseline=c.textBaseline||b.textBaseline,b.fillText(e,a(d[0],0),a(d[1],0),c.maxWidth),b.restore()},qa=(a)=>({ctx:a,canvas:a.canvas,translate:R(a),rotate:S(a),moveTo:V(a),lineTo:W(a),quadraticCurveTo:X(a),arc:Y(a),drawLine:aa(a),drawPolygon:ba(a),drawArc:da(a),drawImage:$(a),drawSlicedImage:_(a),fillRectangle:ha(a),fillPolygon:ga(a),fillLine:ia(a),fillArc:ja(a),fillText:pa(a),strokePolygon:ka(a),strokeRectangle:la(a),strokeLine:ma(a),strokeArc:na(a),strokeText:oa(a),clearRect:T(a),clear:U(a,a.canvas)});class ra{constructor(){this.position=Q,this.rotation=0,this.saved_positions=[],this.saved_rotations=[]}apply(a){const b=[this.position[0],this.position[1]],c=this.rotation;return Object.assign(Object.create(null),a,{id:E(),position:b,rotation:c})}save(){this.saved_positions.push([this.position[0],this.position[1]]),this.saved_rotations.push(this.rotation)}restore(){if(0<this.saved_positions.length){const a=this.saved_positions.pop();a&&(this.position[0]=a[0],this.position[1]=a[1]);const b=this.saved_rotations.pop();!b&&0!==b||(this.rotation=b)}}}const sa=(a,b)=>n((b[2]-b[0])*(a[1]-b[1])-(b[3]-b[1])*(a[0]-b[0])),ta=(a,b,c)=>u(q(a,b))<=o(c),ua=(a,b,c,d)=>g(a[0]-b[0])<=c/2&&g(a[1]-b[1])<=d/2,va=(a,b)=>{const c=Math.floor(b.length/2);for(let d=0;d<c;d+=2){const e=d==c-1?0:d+1;if(-1===sa(a,[b[d],b[d+1],b[e],b[e+1]]))return!0}return!1},wa=(a,b,c,d,g)=>ua(a,c,d,g)||ta(c,a,b)||o(a[0]-e(c[0],f(a[0],c[0]+d)))+o(a[1]-e(c[1],f(a[1],c[1]+g)))<o(b),xa=(a,b,c,d,e,f)=>!(g(d[0]-a[0])>b/2+e/2||g(d[1]-a[1])>c/2+f/2),ya=(a,b,c,d)=>{if(va(a,d)||va(c,b))return!0;const f=e(b.length,d.length);for(let e=0;e<f;e+=2)if(e<b.length&&va([b[e],b[e+1]],d)||e<d.length&&va([d[e],d[e+1]],b))return!0;return!1},za=new Map,Aa=new Map,Ba=new Map,Ca=G([0,0],0,window.innerWidth,window.innerHeight,`window`);window.onresize=()=>Object.assign(Ca,G([0,0],0,window.innerWidth,window.innerHeight,`window`));const Da=((a=Ca)=>(b)=>{const{geometry:c={shape:null}}=b;switch(c.shape){case`Circle`:return wa(c.position,c.radius,a.position,a.width,a.height);case`Rectangle`:return xa(c.position,c.width,c.height,a.position,a.width,a.height);case`Polygon`:return ya(c.position,A(D(c.points,[0,0],c.rotation),c.position),a.position,A(D(a.points,[0,0],a.rotation),a.position));default:return!0;}})(Ca),Ea=(a,c)=>(d)=>{const{geometry:e,children:f,render:g,interact:h}=d,{ctx:i,translate:j,rotate:k}=c;i.save(),a.save(),e&&(j(e.position),p(a.position,b(e.position,a.rotation)),k(e.rotation),a.rotation+=e.rotation),i.save(),g&&(!e||Da(a.apply(e)))&&g(c,d),i.restore(),f&&f.forEach(Ea(a,c)),h&&(h.onMouseDown?za.set(d,[d,e&&a.apply(e),h.onMouseDown]):za.delete(d),h.onMouseMove?Aa.set(d,[d,e&&a.apply(e),h.onMouseMove]):Aa.delete(d),h.onMouseUp?Ba.set(d,[d,e&&a.apply(e),h.onMouseUp]):Ba.delete(d)),i.restore(),a.restore()},Fa=`ontouchstart`in window,Ga=(a)=>{if(a.clientX)return[a.clientX,a.clientY];else{const b=a.touches[0];return[b.clientX,b.clientY]}},Ha=(a)=>(b)=>{switch(b.shape){case`Circle`:return ta(a,b.position,b.radius);case`Rectangle`:return ua(a,b.position,b.width,b.height);case`Polygon`:return va(a,A(D(b.points,[0,0],b.rotation),b.position));default:return!1;}},Ia=(a)=>(b)=>{if(a.size){const c=r(Ga(b),[L,M]);c[0]*=N,c[1]*=O;const d=Ha(c);[...a.values()].filter(([a,b])=>!b||d(b)).forEach(([a,b,d])=>d(a,c))}},Ja=[],Ka=()=>{for(;Ja.length;)Ja.pop()},{palette:La,render:Ma}=((a,b)=>{const c=qa(a.getContext(`2d`));return c.clear(),a.addEventListener(Fa?`ontouchstart`:`mousedown`,Ia(za)),a.addEventListener(Fa?`ontouchmove`:`mousemove`,Ia(Aa)),a.addEventListener(Fa?`ontouchend`:`mouseup`,Ia(Ba)),{palette:c,render:()=>Ea(new ra,c)(b)}})(H,{geometry:G([H.width/2,H.height/2],0,H.width,H.height),children:Ja,render({canvas:a},{geometry:b}){b.position[0]=a.width/2,b.position[1]=a.height/2,b.width=a.width,b.height=a.height,b.points=F(b.width,b.height)}}),Na=new AudioContext,Oa=(a)=>new Promise((b)=>setTimeout(b,a)),Pa=Date.now();let Qa=!1;const Ra=82.41,Sa=87.31,Ta=98,Ua=110,Va=130.81,Wa=164.81,Xa=174.61,Ya=196,Za=220,$a=246.94,_a=261.63,ab=293.66,bb=329.63,cb=349.23,db=392,eb=440,fb=493.88,gb=523.25,hb=587.33,ib=659.26,jb=783.99,kb=880,lb=987.77,mb=async()=>await d([[[bb,_a],1],[[ab,Ya],1],[[_a,Za],1],[[$a,Wa],1],[[Za,Xa],1],[[Ya,Va],1],[[Za,Xa],1],[[$a,Ya],1],[[1318.51,jb,gb],1],[[1174.66,lb,db],1],[[1046.5,eb],1],[[lb,jb,bb],1],[[kb,gb,cb],1],[[jb,ib,_a],1],[[kb,698.46,cb],1],[[lb,hb,db],1],[[gb,_a,bb],[0.5,1,1]],[gb,0.5],[[hb,ab,Ya],[0.5,1,1]],[fb,0.5],[[gb,bb,eb],[0.5,1,1]],[ib,0.5],[[jb,Wa],[0.5,1,1]],[db,0.5],[[eb,Za,Xa],[0.5,1,1]],[cb,0.5],[[bb,Va],[0.5,1,1]],[db,0.5],[[cb,Za,Xa],[0.5,1,1]],[gb,0.5],[[fb,$a,Ya],[0.5,1,1]],[db,0.5],[[_a,Wa,Va],[0.5,1,1]],[bb,0.25],[db,0.25],[[db,Ta],[0.25,1,1]],[eb,0.25],[db,0.25],[cb,0.25],[[bb,Ua,Va],[0.75,1,1]],[bb,0.25],[[bb,Ta,Ra],[0.25,1,1]],[cb,0.25],[bb,0.25],[ab,0.25],[[_a,Ua,Sa],[0.25,1,1]],[233.08,0.25],[Za,0.25],[$a,0.25],[[Ya,Ra,65.41],[0.5,1,1]],[Wa,0.5],[[Va,Ua,Sa],[0.5,1,1]],[Xa,0.25],[Wa,0.25],[[146.83,123.47,Ta],[0.5,1,1]],[Ya,0.25],[Xa,0.25],[[``,bb,_a],[0.5,1,1]],[gb,0.5],[[hb,Ya],[0.5,1,1]],[fb,0.5],[[gb,_a,Za],[0.5,1,1]],[bb,0.5],[[db,$a,Wa],[0.75,1,1]],[eb,0.25],[[cb,Za,Xa],[0.5,1,1]],[_a,0.5],[[bb,Ya,Va],[0.5,1,1]],[db,0.5],[[cb,Za,Xa],[0.5,1,1]],[bb,0.5],[[ab,$a,Ya],[0.5,1,1]],[db,0.5],[[bb,_a,Va],[2,2,2]]]),nb=()=>{Qa=!0},ob={38:`up`,40:`down`,37:`left`,39:`right`,81:`q`,87:`w`,69:`e`,65:`a`,83:`s`,68:`d`,48:`0`,49:`1`,50:`2`,51:`3`,52:`4`,53:`5`,54:`6`,55:`7`,56:`8`,57:`9`,189:`-`,187:`=`,32:`space`,13:`return`,16:`shift`,17:`ctrl`,9:`tab`,18:`alt`},pb={up:!1,down:!1,left:!1,right:!1,q:!1,w:!1,e:!1,a:!1,s:!1,d:!1,0:!1,1:!1,2:!1,3:!1,4:!1,5:!1,6:!1,7:!1,8:!1,9:!1,"-":!1,"=":!1,space:!1,return:!1,shift:!1,ctrl:!1,tab:!1,alt:!1,click:!1},qb=(a,b=!0)=>{const c=ob[a];return c&&(pb[c]=b),pb[c]};document.body.onkeyup=({keyCode:a})=>qb(a,!1),document.body.onkeydown=({keyCode:a})=>qb(a,!0);const rb=`Arial Black, Gadget, sans-serif`,sb=`"Lucida Console", Monaco, monospace`,tb=`24px ${rb}`,ub=`12px ${sb}`,vb=`\uD83D\uDC69\uD83C\uDFFC\u200D\uD83C\uDF3E`,wb=`\uD83D\uDC6E\uD83C\uDFFF\u200D\u2640\uFE0F`,xb=`\uD83D\uDD75\uD83C\uDFFD`,yb=`\uD83D\uDC69\uD83C\uDFFB\u200D\uD83C\uDFA4`,zb=`\uD83C\uDF32`,Ab=`\uD83C\uDF33`,Bb=`\u2601\uFE0F`,Cb=`\uD83C\uDF75`,Db=`\uD83D\uDC8E`;let Eb=0,Fb=0;var t=(a)=>{let b=!0;return requestAnimationFrame(function c(){Eb=f(16,Date.now()-Fb),b&&a(Eb),Fb=Date.now(),requestAnimationFrame(c)}),()=>b=!b};let Gb;const Hb=(a)=>{Ka(),a.init(),Gb&&Gb.dismiss(),Gb=a},Ib=[0,120,200],Jb=((a)=>([b,c])=>{const[d,e,f]=a;return[b+c*(d-b)/(c+e)-d+J/2,K-(0===e+c?0:f*c/(e+c)),k(l(e+c,2)+l(d-b,2))]})(Ib),Kb=[],{fillPolygon:Lb,fillText:Mb,ctx:Nb}=La,Ob=G([0,800],0,1e4,1600),Pb=G([0,0],0,2*J,2*K),Qb=Nb.createLinearGradient(0,0,200,200);Qb.addColorStop(0,`#5E8C6A`),Qb.addColorStop(1,`#BFB35A`);const Rb=Nb.createLinearGradient(0,0,200,200);Rb.addColorStop(0,`#69D2E7`),Rb.addColorStop(1,`#A7DBD8`);const Sb=()=>{Lb(Rb,[0,0],Pb.points),Lb(Qb,[0,0],y(z(Ob.points,Ob.position),Jb)),Kb.map((a)=>[...Jb(a),a[2],a[3],a[4]]).sort((c,a)=>a[2]-c[2]).forEach(([a,b,c,d,e])=>Mb({},[a,b-d],e))},Tb={dialog:[[`yolo`,[yb,`ya mum`]]],position:[0,0]},Ub=(a)=>([b,c],d=0)=>[b,c,d,a],Vb=Ub(zb),Wb=Ub(Ab),Xb=Ub(vb),Yb=Ub(wb),Zb=Ub(xb),$b=Ub(yb),_b=Ub(Bb),ac=Ub(Cb),bc=Ub(Db),cc=[0,0],dc=3;let ec=1e3;for(;0<--ec;)Kb.push((0.5<Math.random()?Vb:Wb)([5120*Math.random()-2560,1280*Math.random()],0));for(ec=25;0<--ec;)Kb.push(_b([1e4*Math.random()-5e3,1e3*Math.random()+3500],30*Math.random()+10));for(ec=5;0<--ec;)Kb.push(ac([5120*Math.random()-2560,1280*Math.random()],0));const i=$b([20*Math.random()-10,20*Math.random()-10],0),fc=Xb([20*Math.random()-10,20*Math.random()-10],0),gc=Yb([20*Math.random()-10,20*Math.random()-10],0),hc=Zb([20*Math.random()-10,20*Math.random()-10],0),ic=bc([20*Math.random()-10,20*Math.random()-10],0),jc=()=>(a,b)=>{const c=q(Tb.position,a);v(c)>b&&p(a,x(c,dc))};Kb.push(i,fc,gc,hc,ic);var kc={init:()=>{cc[0]=0,cc[1]=0,(pb.w||pb.up)&&(cc[1]+=1),(pb.s||pb.down)&&(cc[1]-=1),(pb.d||pb.right)&&(cc[0]+=1),(pb.a||pb.left)&&(cc[0]-=1),p(Tb.position,x(cc,dc)),Tb.position[1]=e(Tb.position[1],5),i[0]=Tb.position[0],i[1]=Tb.position[1];const a=jc(i);a(fc,20+Date.now()%300/30),a(gc,45+Date.now()%300/30),a(hc,70+Date.now()%300/30),a(ic,90+Date.now()%300/30);const b=Tb.position[0]-Ib[0];g(b)>0.2*J&&(Ib[0]+=b-0.2*(n(b)*J))}};let lc;var mc={init:()=>{lc=t((a)=>{kc.init(a),La.clear(),Sb(),Ma()})},dismiss:()=>{lc()}};let nc=null,oc=0,pc=0;const qc={textBaseline:`middle`,style:`white`,font:tb},rc={geometry:G([0,0],0,H.width,H.height),render:({ctx:a,fillText:b,fillPolygon:c})=>{if(nc||(nc=Date.now(),mb()),pc=Date.now()-nc,oc=f(pc/24000,1),b(qc,[1<pc/24000?-11:10*(g((pc-1500)%6e3/600-5)-2.5)-11,H.height-1.125*(f(pc/24000,1)*H.height)],Db),b(qc,[-59,-H.height/2+f(2*oc,1)*H.height/2],`A L T E R`),24500<pc){a.font=ub;const{width:d}=a.measureText(`new game`);b({style:`white`,font:ub},[-d/2-2,48],`new game`),400<Date.now()%600&&c(`white`,[-42,44],[-5,3,5,0,-5,-3])}(pb.space||pb.return)&&1>oc?nc/=2:(pb.space||pb.return)&&Hb(mc)},interact:{onMouseDown(){1>oc?nc/=2:Hb(mc)}}};let sc;Hb({init:()=>{nc=null,Ja.push(rc),sc=t(()=>{La.clear(),Ma()})},dismiss:()=>{nb();const a=Ja.indexOf(rc);Ja.splice(a,1),sc()}})})();